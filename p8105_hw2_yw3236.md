p8105\_hw2\_yw3236
================
Yishan Wang
2018-10-01

Problem 1
=========

### Read and clean the data

-   Retain line, station, name, station latitude / longitude, routes served, entry, vending, entrance type, and ADA compliance.

-   Convert the entry variable from character (`YES` vs `NO`) to a logical variable.

``` r
transit_data = 
  read_csv(file = "./NYC_Transit_Subway_Entrance_And_Exit_Data.csv") %>% 
  janitor::clean_names() %>% 
  select(., "line", "station_name", "station_latitude", "station_longitude", "route1":"route11", "entry", "vending", "entrance_type", "ada") %>%
  mutate(., entry = recode(entry, YES = TRUE, NO = FALSE))
```

    ## Parsed with column specification:
    ## cols(
    ##   .default = col_character(),
    ##   `Station Latitude` = col_double(),
    ##   `Station Longitude` = col_double(),
    ##   Route8 = col_integer(),
    ##   Route9 = col_integer(),
    ##   Route10 = col_integer(),
    ##   Route11 = col_integer(),
    ##   ADA = col_logical(),
    ##   `Free Crossover` = col_logical(),
    ##   `Entrance Latitude` = col_double(),
    ##   `Entrance Longitude` = col_double()
    ## )

    ## See spec(...) for full column specifications.

### A short paragraph about this dataset

The variables that dataset contains are `line`, `station_name`, `station_latitude`, `station_longitude`, `rout1` to `rout11`, `entry`, `vending`, `entrence_type`, `ada`. After reading the dataset to R, I used `janitor::clean_names()` to clean the variable names. Then I used `select` to selecte the variables that I want to keep in the dataset and delete other unwanted variables. Lastly, I used `mutate` and `recode` to convert the `entry` from character variable to logical variable. The dimension of the resulting dataset is 1868 x 19. Yes, the data are tidy.

### Answering the questons

``` r
nrow(distinct(transit_data, line, station_name))
```

    ## [1] 465

The number of the distinct stations are 465.

``` r
station_ada = 
  distinct(transit_data, line, station_name, .keep_all = TRUE) %>%
  dplyr::filter(., ada == TRUE)
nrow(station_ada)
```

    ## [1] 84

There are 84 stations that are ADA compliant.

``` r
vending_no = transit_data %>%
  dplyr::filter(., vending == 'NO')

prop = nrow(dplyr::filter(vending_no, entry == TRUE)) / nrow(vending_no)
prop
```

    ## [1] 0.3770492

The proportion of station entrances / exists without vending allow entrance is 0.3770492.

``` r
reform_data = transit_data %>%
  gather(., key = route_num, value = route_name, route1:route11) %>%
  dplyr::filter(., route_name == 'A')

dist_station_serve_A = distinct(reform_data, line, station_name, .keep_all = TRUE)
nrow(dist_station_serve_A)
```

    ## [1] 60

``` r
dist_ada_station_serve_A = dplyr::filter(dist_station_serve_A, ada == TRUE)
nrow(dist_ada_station_serve_A)
```

    ## [1] 17

There are 60 distinct stations serve A train, and 17 of them are ADA compliant.

Problem 2
=========

### Read and clean the Mr. Trash Wheel sheet

-   Specify the sheet in the Excel file and to omit columns containing notes.

-   Omit rows that do not include dumpster-specific data.

-   Rounds the number of sports balls to the nearest integer and converts the result to an integer variable.

``` r
trash_data = 
  readxl::read_excel("./HealthyHarborWaterWheelTotals2017-9-26.xlsx", sheet = 1, range = cellranger::cell_cols("A:N")) %>% 
  janitor::clean_names() %>%
  dplyr::filter(., !is.na(dumpster)) %>%
  mutate(sports_balls = round(sports_balls)) %>%
  mutate(sports_balls = as.integer(.$sports_balls))
```

### Read and clean precipitation data for 2016 and 2017

-   For each, omit rows without precipitation data and add a variable year.

``` r
prec_17 =
  readxl::read_excel("./HealthyHarborWaterWheelTotals2017-9-26.xlsx", sheet = 3, range = cellranger::cell_cols("A:B")) %>% 
  janitor::clean_names() 

names(prec_17) = as.matrix(prec_17[1, ])
prec_17 = prec_17[-1, ]
prec_17[] = lapply(prec_17, function(x) type.convert(as.character(x))) 

prec_17_new = prec_17 %>%
  janitor::clean_names() %>%
  dplyr::filter(., !is.na(.$total)) %>%
  mutate(., year = '2017')
```

``` r
prec_16 =
  readxl::read_excel("./HealthyHarborWaterWheelTotals2017-9-26.xlsx", sheet = 4, range = cellranger::cell_cols("A:B")) %>% 
  janitor::clean_names() 

names(prec_16) = as.matrix(prec_16[1, ])
prec_16 = prec_16[-1, ]
prec_16[] = lapply(prec_16, function(x) type.convert(as.character(x))) 

prec_16_new = prec_16 %>%
  janitor::clean_names() %>%
  dplyr::filter(., !is.na(.$total)) %>%
  mutate(., year = '2016')
```

-   Combine datasets and convert month to a character variable.

``` r
prec = left_join(prec_16_new, prec_17_new, by = "month") 
prec
```

    ## # A tibble: 13 x 5
    ##    month total.x year.x total.y year.y
    ##    <int>   <dbl> <chr>    <dbl> <chr> 
    ##  1     1    3.23 2016      2.34 2017  
    ##  2     2    5.32 2016      1.46 2017  
    ##  3     3    2.24 2016      3.57 2017  
    ##  4     4    1.78 2016      3.99 2017  
    ##  5     5    5.19 2016      5.64 2017  
    ##  6     6    3.2  2016      1.4  2017  
    ##  7     7    6.09 2016      7.09 2017  
    ##  8     8    3.96 2016      4.44 2017  
    ##  9     9    4.53 2016     NA    <NA>  
    ## 10    10    0.62 2016     NA    <NA>  
    ## 11    11    1.47 2016     NA    <NA>  
    ## 12    12    2.32 2016     NA    <NA>  
    ## 13    NA   39.9  2016     29.9  2017

``` r
prec %>%
  dplyr::rename(., total_2016 = total.x, total_2017 = total.y) %>%
  select(., -year.x, -year.y) %>%
  mutate(., month.abb[month]) %>%
  select(., -month) %>%
  dplyr::rename(., month = `month.abb[month]`) %>%
  select(., month, total_2016, total_2017)
```

    ## # A tibble: 13 x 3
    ##    month total_2016 total_2017
    ##    <chr>      <dbl>      <dbl>
    ##  1 Jan         3.23       2.34
    ##  2 Feb         5.32       1.46
    ##  3 Mar         2.24       3.57
    ##  4 Apr         1.78       3.99
    ##  5 May         5.19       5.64
    ##  6 Jun         3.2        1.4 
    ##  7 Jul         6.09       7.09
    ##  8 Aug         3.96       4.44
    ##  9 Sep         4.53      NA   
    ## 10 Oct         0.62      NA   
    ## 11 Nov         1.47      NA   
    ## 12 Dec         2.32      NA   
    ## 13 <NA>       39.9       29.9
